<?xml version="1.0" encoding="utf-8"?>
<!--http://blogs.msdn.com/b/dukek/archive/2009/10/19/implementing-a-wix-installer-that-calls-the-gdr-version-of-vsdbcmd-exe.aspx-->
<Include>
  <!-- This ?define block wasn't working for me, the code paths were evaluating to C:\Program Files\Microsoft Visual Studio 10.0\VSTSDB\Deploy\ - which was wrong
          hence, commented out this part and have just set SrcArchPath explicitly
  <?if $(var.Platform)=x64 ?>
  <?define SrcArchPath = "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VSTSDB\Deploy\"?>
  <?else?>
  <?define SrcArchPath = "C:\Program Files\Microsoft Visual Studio 10.0\VSTSDB\Deploy\"?>
  <?endif?>
  -->
  <!--<?define SrcArchPath = "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VSTSDB\Deploy\"?>-->
  <?define SrcArchPath = "C:\Program Files (x86)\Microsoft SQL Server\120\DAC\bin\"?>
  <?define SSDT = "C:\Program Files (x86)\Microsoft SQL Server\120\DAC\bin\"?>
  <!--
  Duke on checksum:
  This attribute tells the Windows Installer that the file has a checksum that may be used to validate that 
    the file hasn’t been tampered with. You should always set it to "yes" for executables (dll’s and exe’s). 
  -->
  <!--<DirectoryRef Id="INSTALLLOCATION">
    <Component Id="MicrosoftDataSchema" Guid="AA67D22F-12E9-4034-BD7D-7210A43050BD">
      <File Id="Microsoft.Data.Schema.dll" Source="$(var.SrcArchPath)Microsoft.Data.Schema.dll" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="MicrosoftDataSchemaScriptDom" Guid="AA17D22F-22E9-4034-BD7D-7210A43050BD">
      <File Id="Microsoft.Data.Schema.ScriptDom.dll" Source="$(var.SrcArchPath)Microsoft.Data.Schema.ScriptDom.dll" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="MicrosoftDataSchemaScriptDomSql" Guid="AA67D22F-32E9-4034-BD7D-7210A43050BD">
      <File Id="Microsoft.Data.Schema.ScriptDom.Sql.dll" Source="$(var.SrcArchPath)Microsoft.Data.Schema.ScriptDom.Sql.dll" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="MicrosoftDataSchemaSql" Guid="AA67D22F-42E9-4034-BD7D-7210A43050BD">
      <File Id="Microsoft.Data.Schema.Sql.dll" Source="$(var.SrcArchPath)Microsoft.Data.Schema.Sql.dll" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="Vsdbcmd" Guid="AA67D22F-52E9-4034-BD7D-7210A43050BD">
      <File Id="vsdbcmd.exe" Source="$(var.SrcArchPath)vsdbcmd.exe" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="VsdbcmdConfig" Guid="AA67D22F-52E9-4034-BD7D-7210A43050BA">
      <File Id="vsdbcmd.exe.config" Source="$(var.SrcArchPath)vsdbcmd.exe.config" KeyPath="yes" Checksum="yes"/>
    </Component>
  </DirectoryRef>

  <DirectoryRef Id="SqlServer">
    <Component Id="DatabaseSchemaProvidersExtensionsXml" Guid="AA67D22F-62E9-4034-BD7D-7210A43050BD">
      <File Id="DatabaseSchemaProviders.Extensions.Xml" Source="$(var.SrcArchPath)Extensions\SqlServer\DatabaseSchemaProviders.Extensions.xml" KeyPath="yes"/>
    </Component>
  </DirectoryRef>-->

    <ComponentGroup Id="SqlPackageComponents" Directory="DACINSTALLFOLDER">
    <Component Id="Comp.SqlPackage.exe" Guid="*">
        <File Id="File.SqlPackage.exe" Source="$(var.SSDT)SqlPackage.exe" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="Comp.SqlPackage.exe.config" Guid="*">
        <File Id="File.SqlPackage.exe.config" Source="$(var.SSDT)SqlPackage.exe.config" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="Comp.Microsoft.Data.Tools.Schema.Sql.dll" Guid="*">
        <File Id="File.Microsoft.Data.Tools.Schema.Sql.dll" Source="$(var.SSDT)Microsoft.Data.Tools.Schema.Sql.dll" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="Comp.Microsoft.Data.Tools.Utilities.dll" Guid="*">
        <File Id="File.Microsoft.Data.Tools.Utilities.dll" Source="$(var.SSDT)Microsoft.Data.Tools.Utilities.dll" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="Comp.Microsoft.SqlServer.Dac.dll" Guid="*">
        <File Id="File.Microsoft.SqlServer.Dac.dll" Source="$(var.SSDT)Microsoft.SqlServer.Dac.dll" KeyPath="yes" Checksum="yes"/>
    </Component>
    <Component Id="Comp.Microsoft.SqlServer.TransactSql.ScriptDom.dll" Guid="*">
        <File Id="File.Microsoft.SqlServer.TransactSql.ScriptDom.dll" Source="$(var.SSDT)Extensions\Microsoft.SqlServer.TransactSql.ScriptDom.dll" KeyPath="yes" Checksum="yes"/>
    </Component>
</ComponentGroup>

  <!--<DirectoryRef Id="DbSchemas">
    <Component Id="MicrosoftSqlTypes" Guid="AA67D22F-12E9-4034-BD7D-7250A43050BD">
      <File Id="MicrosoftSqlTypesDbschema" Source="$(var.SrcArchPath)Extensions\SqlServer\2008\DBSchemas\Microsoft.SqlTypes.dbschema" KeyPath="yes"/>
    </Component>
  </DirectoryRef>-->
  <!--Install the Visual Studio 10.0 registry key if it doesn't exist. -->
  <!--This <Component> defines the registry key that will be 
        created assuming the <RegistrySearch> came back empty.-->
  <!--<Feature Id="RegistryPreReqs" Title="Registry Prerequisites" Level="1">
    <ComponentRef Id="RegistryEntries"/>
    <Condition Level="0">NOT VISUALSTUDIOREGISTRY</Condition>
  </Feature>-->

  <!--VSDBCMD requires this REGKEY to be installed. Note that this will NOT be true for the Visual Studio 2010 version-->
  <!--HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\9.0-->

  <!-- Define the search for the Visual Studio 9.0 registry key -->
  <!--VISUALSTUDIOREGISTRY is a property that represents the results of the <RegistrySearch>. The 
          attributes of the element define the particular registry key to search for.-->
  <!--<Property Id="VISUALSTUDIOREGISTRY">
    <RegistrySearch Id="VisualStudio100Registry"
                    Root="HKCU"
                    Key="Software\Microsoft\VisualStudio\10.0"
                    Name="(Default)"
                    Type="raw" />
  </Property>-->

  <!-- Define the Visual Studio 9.0 Registry entry-->
  <!--<DirectoryRef Id="TARGETDIR">
    <Component Id="RegistryEntries" Guid="AA67D22F-12E9-4034-BD7D-7212A43050BD">
      <RegistryKey Root="HKCU"
                   Key="Software\Microsoft\VisualStudio\9.0"
                   Action="create"
                     >
        <RegistryValue Type="string" Name="(Default)" Value="Default Value" KeyPath="no"/>
      </RegistryKey>
    </Component>
  </DirectoryRef>-->
</Include>
